<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-12</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.g_mine += 1;
//global.rage_mine[global.g_mine] = instance_id;

defenders = 0;
mySoldiers = 0;
defenders_hp = defenders * global.s_hp;
gold = global.gold_max;

click = true;
nsf = true;
full = true;

have_mine = true;
my_worker = 0;
goblins_amount = 0;
obj_type = "goldmine";
my_capacity = global.g_inmine-round(random(2))+round(random(4));
ghp_now = goblins_amount * global.g_hp;

bord = 48; //как далеко от голдмайна (для miner_/def_amount_obj

//alarm[2] = global.gobspawn;
//alarm[6] = room_speed;

myKirka = instance_create(x + 40,y - 16,kirka_obj);
mySword = instance_create(x + 40,y + 16,sword_obj);
myAxe = instance_create(x,y - 42,axe_obj);

myKirka.amount = my_worker;
mySword.amount = defenders;
myAxe.amount = goblins_amount;

direction = round(random(359));
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.a += 1;
    if global.a &gt; global.goldmine_max {
        global.a = 1;
    }

global.target_array[global.a] = id;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.g_mine -= 1;

with (mySword) {
    instance_destroy();
}

with (myKirka) {
    instance_destroy();
}

with (myAxe) {
    instance_destroy();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if have_mine = true {
    randomize();
    chance = round(random(299)); 
    if chance = 1 {
        have_mine = false;
         
        if defenders &lt; 1 {
        have_mine = false;
        text = instance_create(room_width / 2,0,top_text_control);
        text.myPapa = "Goblin";
        msg = round(random(1));
                
            if msg = 0 {
                text.txt = "One of the mines captured by goblins.";
            }
                    
            if msg = 1 {
                text.txt = "Mine in dirty paws enemy!"
            }
        goblins_amount = 1 + round(random(2));
        global.rage_now += goblins_amount;
        ghp_now = goblins_amount * global.g_hp;
        alarm[3] = room_speed * (7.1 + random(4.8)); //время респа гоблина
    }
    else {
        ga_have = 2 + round(random(3));
        def_now = defenders;
        goblins_amount = ceil(((ga_have * global.g_hp) - (defenders * (global.s_minatk + round(random(global.s_maxatk - global.s_minatk))))) / global.g_hp); //до большего числа
        defenders = round(((def_now * global.s_hp) - (ga_have * (global.g_minatk + round(random(global.g_maxatk - global.g_minatk))))) / global.s_hp); //до большего числа
        //надо добавить какую-то анимацию боя, что мол подрались и исчезли дефендеры
        
            if goblins_amount &gt; 0 {
                have_mine = false;
                global.rage_now += goblins_amount;
                ghp_now = goblins_amount * global.g_hp;
                defenders = 0;
                alarm[3] = room_speed * (7.1 + random(4.8));
                text = instance_create(room_width / 2,0,top_text_control);
                text.myPapa = "Goblin";
                msg = round(random(1));
                
                    if msg = 0 {
                        text.txt = "One of the mines captured by goblins.";
                    }
                    
                    if msg = 1 {
                        text.txt = "Mine in dirty paws enemy!"
                    }
            }
        }
    }
    alarm[6] = room_speed; 
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if goblins_amount &gt; 0 {
  goblins_amount -= 1;
  goblin = instance_create(x - random(32) + random(32),y - random(8) + random(8),goblin_obj);
  goblin.myPapa = "goldmine";
  alarm[5] = 5 + (5 + random(4));
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>full = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if have_mine = false &amp;&amp; goblins_amount &lt; global.g_inmine
{
  goblins_amount += 1;
  global.rage_now += 1;
  ghp_now = goblins_amount * global.g_hp;
  alarm[3] = room_speed*(7.1+round(random(4.8))); //время респа гоблина
}
else {
    alarm[2] = global.gobspawn;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>gm_parent</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>randomize();
spawn = round(random(99));

if spawn &lt; 65 {
  alarm[2] = global.gobspawn / (1 + random(2));
}
else
{
    if defenders &lt; 1 {
        have_mine = false;
        text = instance_create(room_width / 2,0,top_text_control);
        text.myPapa = "Goblin";
        msg = round(random(1));
                
            if msg = 0 {
                text.txt = "One of the mines captured by goblins.";
            }
                    
            if msg = 1 {
                text.txt = "Mine in dirty paws enemy!"
            }
        goblins_amount = 1 + round(random(2));
        global.rage_now += goblins_amount;
        ghp_now = goblins_amount * global.g_hp;
        alarm[3] = room_speed * (7.1 + random(4.8)); //время респа гоблина
    }
    else {
        ga_have = 2 + round(random(3));
        def_now = defenders;
        goblins_amount = ceil(((ga_have * global.g_hp) - (defenders * (global.s_minatk + round(random(global.s_maxatk - global.s_minatk))))) / global.g_hp); //до большего числа
        defenders = round(((def_now * global.s_hp) - (ga_have * (global.g_minatk + round(random(global.g_maxatk - global.g_minatk))))) / global.s_hp); //до большего числа
        //надо добавить какую-то анимацию боя, что мол подрались и исчезли дефендеры
        
            if goblins_amount &gt; 0 {
                have_mine = false;
                global.rage_now += goblins_amount;
                ghp_now = goblins_amount * global.g_hp;
                defenders = 0;
                alarm[3] = room_speed * (7.1 + random(4.8));
                text = instance_create(room_width / 2,0,top_text_control);
                text.myPapa = "Goblin";
                msg = round(random(1));
                
                    if msg = 0 {
                        text.txt = "One of the mines captured by goblins.";
                    }
                    
                    if msg = 1 {
                        text.txt = "Mine in dirty paws enemy!"
                    }
            }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>nsf = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>click = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if goblins_amount &gt; 0 {
    have_mine = false;
}
else {
    have_mine = true;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if gold &lt;= 0 {
    my_worker = 0;
    
        if defenders &gt; 0 {
            soldier = instance_create(x,y,soldier_village);
            defenders -= 1;
            global.mySoldiers -= 1;
        
                with (soldier) {
                    dir = 1;
                    move_towards_point(base_obj.x,base_obj.y,speed);
                }
        }
        else {
            instance_destroy();
        }
}

defenders_hp = defenders * global.s_hp;

if instance_exists(myKirka) {
    myKirka.amount = my_worker;
}

if instance_exists(mySword) {
    mySword.amount = defenders;
}

if instance_exists(myAxe) {
    myAxe.amount = goblins_amount;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="6" enumb="7">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Worker</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if instance_exists(base_obj) {

    if global.worker = 1 &amp;&amp; have_mine = true {

        if click = true {
  
            if global.miner &lt; global.miner_max {
                        
                if my_worker &lt; 3 {
    
                    if global.miner_free &gt; 0 {
                        global.x_finish = x;
                        global.y_finish = y;
                        instance_create(global.x_start,global.y_start,miner_obj);
                        global.miner_free -= 1;
                        my_worker += 1;
                        click = false;
                        alarm[0] = room_speed / 2;
                        worker = instance_create(x,y,workers_obj);
                        worker.amount = my_worker;
                    }
                    else {
        
                        if global.gold &gt;= global.m_price {
                            global.gold -= global.m_price;
                            global.x_finish = x;
                            global.y_finish = y;
                            txt = instance_create(global.x_start,global.y_start,gold_minus_obj);
                            txt.gold_minus = global.m_price;
                            instance_create(global.x_start,global.y_start,miner_obj);
                            my_worker += 1;
                            click = false;
                            alarm[0] = room_speed / 2;
                            worker = instance_create(x,y,workers_obj);
                            worker.amount = my_worker;
                        }
                        else if global.no_gold = false &amp;&amp; my_worker &lt; 3 {
                            text = instance_create(room_width / 2,0,top_text_control);
                            text.myPapa = "Miner";
                            text.txt = "Need more gold!";
                        }
                    }
                }
                else {
                        
                    if full = true {
                        full = false;
                        alarm[4] = room_speed;
                        instance_create(x,y,full_obj);
                    }
                }

        }
      }
    }
    }

if global.miner &gt;= global.miner_max {

  if global.no_gold = false {
    instance_create(view_xview,view_yview,nogold_obj);
  }
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>Soldier</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if instance_exists(base_obj) {
    
    if global.soldier = 1 {
 
        if global.s_free &gt; 0 &amp;&amp; defenders &lt; 3 {
            global.x_finish = x;
            global.y_finish = y;
            instance_create(global.x_start,global.y_start,soldier_obj);
            
                if have_mine = true {
                    defenders += 1;
                    txt = instance_create(x,y,defender_obj);
                    txt.amount = defenders;
                }
            click = false;
            alarm[0] = room_speed / 2;
        }
        else {
    
            if click = true {
    
                if global.s_free &gt; 0 &amp;&amp; defenders &gt; 3 {
                    full = false;
                    alarm[4] = room_speed;
                    instance_create(x,y,full_obj);
                }
                
                if global.gold &gt;= global.soldier_price &amp;&amp; defenders &lt; 3 &amp;&amp; global.s_free &lt;= 0 {
                    global.gold -= global.soldier_price;
                    global.x_finish = x;
                    global.y_finish = y;
                    instance_create(global.x_start,global.y_start,soldier_obj);
                    txt = instance_create(global.x_start,global.y_start,gold_minus_obj);
                    txt.gold_minus = global.soldier_price;
                        
                        if have_mine = true {
                            defenders += 1;
                            txt = instance_create(x,y,defender_obj);
                            txt.amount = defenders; 
                        }
                    click = false;
                    alarm[0] = room_speed / 2;
                }
                else {
                
                    if global.no_gold = false &amp;&amp; defenders &lt; 3 {
                        text = instance_create(room_width / 2,0,top_text_control);
                        text.myPapa = "Soldier";
                        text.txt = "Need more gold!";
                    }
                    
                    if defenders &gt;= 3 &amp;&amp; full = true {
                        full = false;
                        alarm[4] = room_speed;
                        instance_create(x,y,full_obj);
                    }
                }
            }
            else if nsf = true {
                nsf = false;
                alarm[1] = room_speed / 2;
                instance_create(x,y,nsf_obj);
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="72">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if have_mine = true {
    image_index = 0;
}
else {
    image_index = 1;
}

image_angle = direction;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_self();
draw_set_alpha(1);
draw_set_font(price_font);
draw_set_halign(fa_center);
draw_set_color(make_color_rgb(157,19,23));

if have_mine = true {
    draw_healthbar(x - (sprite_width / 2.5),y - 38,x + (sprite_width / 2.5),y - 30,gold / (global.gold_max / 100),c_black,c_orange,c_yellow,180,true,true);
    mySword.vis = true;
    myKirka.vis = true;
    myAxe.vis = false;
}
else {
    mySword.vis = false;
    myKirka.vis = false;
    myAxe.vis = true;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
